
type @state s a = s -> (a, s);
type @stack     = [int];


(@state (@stack) int) pop =
  fun (list) {
    return (list.hd, list);
  };

(int -> @state (@stack) unit) push =
  fun (n) {
    return fun (list) {
      return ((), n : list);
    };
  };


(a -> @state s a) mreturn =
  fun (a) {
    return fun (s) {
      return (a, s);
    };
  };


(@stack) emptystack = [];

(unit -> int) main = fun () {
    (@state (@stack) int) k = mreturn(3);
    return 1;
  };
